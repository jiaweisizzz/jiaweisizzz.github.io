<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
    
  <title>Golang TensorFlow | JARVIS</title>
  <meta name="author" content="jarvis">
  <meta name="description" content="èƒŒæ™¯æœ€è¿‘åœ¨å·¥ä½œä¸­é‡åˆ°äº†TensorFlowï¼Œéœ€è¦ç”¨goè°ƒç”¨å¤„ç†å¥½çš„æ¨¡å‹ã€‚å› ä¸ºåœ¨ä¸Šå®¶å…¬å¸ä¹Ÿæœ‰ç”¨åˆ°è¿‡TensorFlowï¼Œå½“æ—¶ç”¨æ¥æ ¹æ®å¤©æ°”æƒ…å†µé¢„">
  <meta name="keywords" content="blog,developer,personal">

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Golang TensorFlow"/>
<meta name="twitter:description" content="èƒŒæ™¯æœ€è¿‘åœ¨å·¥ä½œä¸­é‡åˆ°äº†TensorFlowï¼Œéœ€è¦ç”¨goè°ƒç”¨å¤„ç†å¥½çš„æ¨¡å‹ã€‚å› ä¸ºåœ¨ä¸Šå®¶å…¬å¸ä¹Ÿæœ‰ç”¨åˆ°è¿‡TensorFlowï¼Œå½“æ—¶ç”¨æ¥æ ¹æ®å¤©æ°”æƒ…å†µé¢„"/>

  <meta property="og:title" content="Golang TensorFlow" />
<meta property="og:description" content="èƒŒæ™¯æœ€è¿‘åœ¨å·¥ä½œä¸­é‡åˆ°äº†TensorFlowï¼Œéœ€è¦ç”¨goè°ƒç”¨å¤„ç†å¥½çš„æ¨¡å‹ã€‚å› ä¸ºåœ¨ä¸Šå®¶å…¬å¸ä¹Ÿæœ‰ç”¨åˆ°è¿‡TensorFlowï¼Œå½“æ—¶ç”¨æ¥æ ¹æ®å¤©æ°”æƒ…å†µé¢„" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jiaweisizzz.github.io/posts/go_tensorflow/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-03-28T00:00:00+00:00" />

  <link rel="stylesheet" href="/css/bootstrap.min.css"  crossorigin="anonymous">
  
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="/sass/main.css">

  <link rel="stylesheet" href="/zoomjs/zoom.min.css">

  <script src=/js/lazysizes.min.js></script>

  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  

</head>



<body ontouchstart="">
  <nav class="navbar navbar-default navbar-custom navbar-fixed-top ">
  <div class="container-fluid">
    
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://jiaweisizzz.github.io">JARVIS</a>
    </div>
    
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          
          <li><a href="/" title="Home">Home</a></li>
          
          <li><a href="/archive/" title="Archive">Archive</a></li>
          
          <li><a href="/tags/" title="Tags">Tags</a></li>
          
          <li><a href="/about/" title="About">About</a></li>
          
          <li><a href="https://github.com/roninro/hugo-theme-puppet/" title="Github">Github</a></li>
          
          <li><a href="" title=""></a></li>
          

          <li class="search-icon">
            <a href="javascript:void(0)">
              <i class="fa fa-search"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
    
  </div>
  
</nav>
<script>
  
  
  
  var $body = document.body;
  var $toggle = document.querySelector(".navbar-toggle");
  var $navbar = document.querySelector("#huxblog_navbar");
  var $collapse = document.querySelector(".navbar-collapse");

  var __HuxNav__ = {
    close: function () {
      $navbar.className = " ";
      
      setTimeout(function () {
        
        if ($navbar.className.indexOf("in") < 0) {
          $collapse.style.height = "0px";
        }
      }, 400);
    },
    open: function () {
      $collapse.style.height = "auto";
      $navbar.className += " in";
    },
  };

  
  $toggle.addEventListener("click", function (e) {
    if ($navbar.className.indexOf("in") > 0) {
      __HuxNav__.close();
    } else {
      __HuxNav__.open();
    }
  });

  

  document.addEventListener("click", function (e) {
    if (e.target == $toggle) return;
    if (e.target.className == "icon-bar") return;
    __HuxNav__.close();
  });
</script>
  
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

  
  


<style type="text/css">
  header.intro-header {
    position: relative;
    background-image: url('/img/go_tensorflow/header.jpg');
  }
</style>

<header class="intro-header ">

  <div class="header-mask"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <div class="tags">
            
            <a class="tag" href="/tags/golang/" title="golang">golang</a>
            
            <a class="tag" href="/tags/tensorflow/" title="tensorflow">tensorflow</a>
            
          </div>
          <h1>Golang TensorFlow</h1>
          <h2 class="subheading">tensorflow è¸©å‘è®°å½•</h2>
          <span class="meta">
            Posted by  jarvis 
            on Tue, Mar 28, 2023
          </span>
        </div>
      </div>
    </div>
  </div>
</header>


  


<article>
  <div class="container">
    <div class="row">

      
      <div class="
              col-lg-8 col-lg-offset-2
              col-md-10 col-md-offset-1
              post-container">
        <h2 id="èƒŒæ™¯">èƒŒæ™¯<a class="anchorjs-link" href="#%e8%83%8c%e6%99%af"></a></h2><p>æœ€è¿‘åœ¨å·¥ä½œä¸­é‡åˆ°äº†TensorFlowï¼Œéœ€è¦ç”¨goè°ƒç”¨å¤„ç†å¥½çš„æ¨¡å‹ã€‚å› ä¸ºåœ¨ä¸Šå®¶å…¬å¸ä¹Ÿæœ‰ç”¨åˆ°è¿‡TensorFlowï¼Œå½“æ—¶ç”¨æ¥æ ¹æ®å¤©æ°”æƒ…å†µé¢„æµ‹å…‰ä¼å‘ç”µçš„è¶‹åŠ¿ï¼Œæ•´ä½“æ¥è¯´è¿˜æ˜¯ä¸é”™çš„ï¼Œä¸è¿‡ç‰ˆæœ¬æ›´æ–°å¤ªå¿«äº†ï¼Œéƒ½å·²ç»æ›´æ–°åˆ°2.xç‰ˆæœ¬äº†ï¼Œæœ¬æ¥ä»¥ä¸ºæ²¡å•¥é—®é¢˜ï¼Œç»“æœè¿˜æ˜¯æƒ³çš„å¤ªç®€å•äº†ã€‚åœ¨è¿™è®°å½•ä¸€ä¸‹ä½¿ç”¨çš„è¿‡ç¨‹å’Œé‡åˆ°çš„ä¸€äº›å‘å§ã€‚</p>
<h2 id="tensorflowhttpstensorflowgooglecnhlzh-cn"><a href="https://tensorflow.google.cn/?hl=zh-cn" target="_blank">TensorFlow</a><a class="anchorjs-link" href="#tensorflowhttpstensorflowgooglecnhlzh-cn"></a></h2><p>ç®€å•ä»‹ç»ä¸€ä¸‹Tensorflowå§ï¼ŒTensorFlow æ˜¯ç”± Google Brain å›¢é˜Ÿå¼€å‘çš„ä¸€ä¸ªå¼€æºæœºå™¨å­¦ä¹ æ¡†æ¶ã€‚å®ƒå¯ç”¨äºæ„å»ºå„ç§äººå·¥æ™ºèƒ½åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å›¾åƒå’Œè¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€æ¨èç³»ç»Ÿç­‰ç­‰ã€‚TensorFlow æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ Pythonã€C++ã€Javaã€Go ç­‰ç­‰ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å¤šç§è®¡ç®—å¹³å°ä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬ CPUã€GPUã€TPU ç­‰ç­‰ã€‚</p>
<p>TensorFlow çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªæ•°æ®æµå›¾è®¡ç®—å¼•æ“ï¼Œå®ƒä½¿ç”¨æ•°æ®æµå›¾æ¨¡å‹æ¥è¡¨ç¤ºè®¡ç®—ä»»åŠ¡ï¼Œå…¶ä¸­èŠ‚ç‚¹è¡¨ç¤ºæ“ä½œï¼Œè¾¹è¡¨ç¤ºæ•°æ®æµã€‚TensorFlow æä¾›äº†ä¸°å¯Œçš„é«˜çº§æ¥å£å’Œå·¥å…·æ¥ç®€åŒ–æœºå™¨å­¦ä¹ ä»»åŠ¡çš„å¼€å‘è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ Kerasã€Estimatorã€TensorBoard ç­‰ç­‰ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿå…è®¸ç”¨æˆ·ä½¿ç”¨ä½çº§æ¥å£å’Œè‡ªå®šä¹‰æ“ä½œæ¥å®ç°æ›´é«˜çº§åˆ«çš„åŠŸèƒ½å’Œæ›´çµæ´»çš„æ§åˆ¶ã€‚</p>
<p>ç”±äº TensorFlow å…·æœ‰å¼€æºã€è·¨å¹³å°ã€é«˜åº¦çµæ´»å’Œå¼ºå¤§çš„åŠŸèƒ½ç­‰ä¼˜ç‚¹ï¼Œå› æ­¤å®ƒå·²æˆä¸ºæœ€å—æ¬¢è¿çš„æœºå™¨å­¦ä¹ æ¡†æ¶ä¹‹ä¸€ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå­¦æœ¯ç ”ç©¶å’Œå•†ä¸šå¼€å‘é¢†åŸŸã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»å®˜ç½‘å­¦ä¹ ä¸€ä¸‹ã€‚</p>
<h2 id="ä½¿ç”¨">ä½¿ç”¨<a class="anchorjs-link" href="#%e4%bd%bf%e7%94%a8"></a></h2><p>åœ¨è¿™é‡Œæˆ‘ä»¬åªä»‹ç»golangå¯¹äºtensorflwoçš„ä½¿ç”¨ã€‚é€šè¿‡å®˜ç½‘æˆ‘ä»¬äº†è§£åˆ°ï¼Œå¯¹äºTensorFlow2.xç‰ˆæœ¬å·²ç»ä¸æ”¯æŒgoçš„apiäº†ï¼Œå¯¹äºgoçš„æ”¯æŒæœ€é«˜åˆ°1.15.5ï¼Œå¹¶ä¸”åœ¨å®˜æ–¹æ–‡æ¡£å®‰è£…Goç‰ˆTensorFlowè¿™ä¸€èŠ‚å·²ç»æç¤ºæˆ‘ä»¬ï¼š</p>
<p><em><strong>æ³¨æ„</strong>ï¼šTensorFlow Go API ä¸åœ¨ TensorFlow <a href="https://www.tensorflow.org/guide/versions?hl=zh-cn" target="_blank">API ç¨³å®šæ€§ä¿éšœ</a>çš„æ¶µç›–èŒƒå›´å†…ã€‚</em></p>
<p>è¿™å°±å¾ˆå¤´ç–¼äº†ï¼Œä¸è¿‡ä¹Ÿä¸èƒ½å®˜æ–¹è¯´å•¥å°±æ˜¯å•¥å§ï¼Œç¡¬ç€å¤´çš®ä¹Ÿå¾—ä¸Šã€‚</p>
<p>ä½¿ç”¨goçš„apiéœ€è¦å…ˆå®‰è£…tensorflowçš„Cåº“ï¼Œå…·ä½“å®‰è£…è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚å½“æˆ‘ä»¬ä¸€åˆ‡å‡†å¤‡å°±ç»ªçš„æ—¶å€™ï¼Œä½¿ç”¨å®˜æ–¹æä¾›çš„åº“è¿›è¡Œæµ‹è¯•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>go get github.com/tensorflow/tensorflow/tensorflow/go
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>go <span style="color:#8be9fd;font-style:italic">test</span> github.com/tensorflow/tensorflow/tensorflow/go
</span></span></code></pre></div><p>å¾—åˆ°äº†è¿™æ ·çš„ç»“æœ</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/1.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<p>æœäº†ä¸€ä¸‹ç¡®å®æ˜¯å› ä¸ºç¼ºå°‘å¯¹2.xç‰ˆæœ¬çš„æ”¯æŒå¯¼è‡´çš„ã€‚å®˜æ–¹ğŸ®ğŸºï¼Œè¯šä¸æ¬ºæˆ‘ã€‚</p>
<p>ä¸è¿‡å·¥ä½œè¿˜å¾—ç»§ç»­ï¼Œåœ¨<code>pkg.go.dev</code>ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªåº“ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>go get github.com/galeone/tensorflow/tensorflow/go
</span></span></code></pre></div><p>ä½¿ç”¨èµ·æ¥è·Ÿå®˜æ–¹å¾ˆåƒï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯åŠ è½½å·²ç»ä¿å­˜å¥½çš„æ¨¡å‹å¹¶è¿›è¡Œé¢„æµ‹å¾—åˆ°ç»“æœã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>model, err <span style="color:#ff79c6">:=</span> tf.<span style="color:#50fa7b">LoadSavedModel</span>(<span style="color:#f1fa8c">&#34;./model&#34;</span>, []<span style="color:#8be9fd">string</span>{<span style="color:#f1fa8c">&#34;serve&#34;</span>}, <span style="color:#ff79c6">nil</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>  <span style="color:#8be9fd;font-style:italic">panic</span>(err)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>inputTensor, _ <span style="color:#ff79c6">:=</span> tf.<span style="color:#50fa7b">NewTensor</span>(black)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>_, err = model.Session.<span style="color:#50fa7b">Run</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>  <span style="color:#8be9fd;font-style:italic">map</span>[tf.Output]<span style="color:#ff79c6">*</span>tf.Tensor{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    model.Graph.<span style="color:#50fa7b">Operation</span>(<span style="color:#f1fa8c">&#34;serving_default_input_1&#34;</span>).<span style="color:#50fa7b">Output</span>(<span style="color:#bd93f9">0</span>): inputTensor,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>  },
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>  []tf.Output{model.Graph.<span style="color:#50fa7b">Operation</span>(<span style="color:#f1fa8c">&#34;StatefulPartitionedCall&#34;</span>).<span style="color:#50fa7b">Output</span>(<span style="color:#bd93f9">0</span>)},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>  <span style="color:#ff79c6">nil</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>  <span style="color:#8be9fd;font-style:italic">panic</span>(err)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>}
</span></span></code></pre></div><p>é¦–å…ˆæˆ‘ä»¬è°ƒç”¨<code>LoadSavedModel</code>æ–¹æ³•åŠ è½½æ¨¡å‹ï¼Œç„¶åç›´æ¥è°ƒç”¨Runæ–¹æ³•å³å¯ã€‚éœ€è¦æ³¨æ„âš ï¸çš„æ˜¯ï¼Œæˆ‘ä»¬è¦å¡«å†™æ­£ç¡®æ¨¡å‹çš„è¾“å…¥å’Œè¾“å‡ºçš„åç§°ï¼Œå¦‚æœè·Ÿä¿å­˜çš„æ¨¡å‹å¯¹ä¸ä¸Šçš„è¯ä¼šæŠ¥é”™ã€‚å¦‚æœä½ ä¸çŸ¥é“æ¨¡å‹åç§°ï¼Œå¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>saved_model_cli show --dir modelpath --tag_set serve --signature_def serving_default
</span></span></code></pre></div><p>å› ä¸ºtensorflowéœ€è¦ä¸€äº›æ€§èƒ½å’Œç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ç›´æ¥å°†ä»£ç æ”¾åˆ°äº†è‡ªå·±ç§Ÿçš„ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œè¿è¡Œç«Ÿç„¶æˆåŠŸäº†ã€‚</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/2.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/3.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<p>ä»è¿è¡Œç»“æœçœ‹ï¼Œ24ä¸‡çš„æ•°æ®ä»æ¨¡å‹åŠ è½½åˆ°é¢„æµ‹ç”¨äº†35så·¦å³ï¼Œç§Ÿç”¨çš„æœåŠ¡å™¨ä¸€å…±12ä¸ªæ ¸å…¨éƒ¨å æ»¡äº†ï¼Œå¦‚æœä¸åŠ é™åˆ¶çš„è¯ï¼Œåœ¨çœŸå®çš„çº¿ä¸Šç¯å¢ƒå¾ˆå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬å…¶ä»–åŠŸèƒ½ä¸æ­£å¸¸ï¼Œæ‰€ä»¥éœ€è¦å¯¹cpuè¿›è¡Œé™åˆ¶ã€‚</p>
<p>é€šè¿‡è¯¢é—®ChatGPTæˆ‘å¾—åˆ°äº†å¦‚ä¸‹ç»“æœï¼š</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/4.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<p>å®è·µçš„è¿‡ç¨‹å‘ç°<code>Config</code>ç±»å‹æ ¹æœ¬ä¸åŒ¹é…ï¼Œç¿»é˜…äº†æºç å‘ç°å…³äºè¿è¡Œçš„é…ç½®åœ¨<em><a href="https://www.tensorflow.org/code/tensorflow/core/protobuf/config.proto" target="_blank">https://www.tensorflow.org/code/tensorflow/core/protobuf/config.proto</a></em>è¿™ä¸ªæ–‡ä»¶å†…</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/8.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<p>åœ¨è·Ÿè¿›è¿™ä¸ªåº“çš„æºç å‘ç°åœ¨protobufç›®å½•ä¸‹å­˜åœ¨config.pb.goæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­æœ‰ä¸ª<code>ConfigProto</code>ç»“æ„ä½“ï¼Œæ­£å¥½èƒ½å¤Ÿè·Ÿä¸Šé¢ç½‘ç«™ä¸Šå¯¹åº”ä¸Šï¼Œå› æ­¤å¤§èƒ†çŒœæµ‹è¿™ä¸ªç»“æ„å°±æ˜¯æ§åˆ¶è¿è¡Œå‚æ•°çš„ã€‚</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/5.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/6.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<p>æˆ‘ä»¬å°†è¿™ä¸ªåŒ…å¯¼å…¥ï¼Œå¹¶ä¿®æ”¹æ¨¡å‹çš„åŠ è½½ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ff79c6">import</span> tp <span style="color:#f1fa8c">&#34;github.com/galeone/tensorflow/tensorflow/go/core/protobuf/for_core_protos_go_proto&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#8be9fd;font-style:italic">var</span> cp tp.ConfigProto
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>cp.InterOpParallelismThreads = <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>cp.IntraOpParallelismThreads = <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>cp.UsePerSessionThreads = <span style="color:#ff79c6">true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>bytes, _ <span style="color:#ff79c6">:=</span> proto.<span style="color:#50fa7b">Marshal</span>(<span style="color:#ff79c6">&amp;</span>cp)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>model, err <span style="color:#ff79c6">:=</span> tf.<span style="color:#50fa7b">LoadSavedModel</span>(<span style="color:#f1fa8c">&#34;./model&#34;</span>, []<span style="color:#8be9fd">string</span>{<span style="color:#f1fa8c">&#34;serve&#34;</span>}, <span style="color:#ff79c6">&amp;</span>tf.SessionOptions{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>  Config: bytes,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>  <span style="color:#8be9fd;font-style:italic">panic</span>(err)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>}
</span></span></code></pre></div><p>è¿è¡Œå†æ¬¡æŸ¥çœ‹cpuçš„ä½¿ç”¨ï¼Œç¡®å®æˆåŠŸé™åˆ°äº†2ä¸ªæ ¸ã€‚</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="img/7.png" data-action="zoom" alt=""  class="lazyload">
  </a>
  
</figure></p>
<h2 id="æ€»ç»“">æ€»ç»“<a class="anchorjs-link" href="#%e6%80%bb%e7%bb%93"></a></h2><ul>
<li>
<p>TensorFlow Go Apiå®˜æ–¹åªæ”¯æŒ2.0ç‰ˆæœ¬ä»¥ä¸‹</p>
</li>
<li>
<p>æ¨èä½¿ç”¨github.com/galeone/tensorflow/tensorflow/goåº“</p>
</li>
<li>
<p>é™åˆ¶cpuå ç”¨å¯ä»¥ä½¿ç”¨github.com/galeone/tensorflow/tensorflow/go/core/protobuf/for_core_protos_go_protoæ¥é…ç½®</p>
<p><strong>æ³¨ï¼š</strong>
TensorFlow ç‰ˆæœ¬éœ€è¦çš„ glibc ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">TensorFlow</th>
<th style="text-align:center">GLIBC</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&gt;= 2.0</td>
<td style="text-align:center">&gt;= 2.3</td>
</tr>
<tr>
<td style="text-align:center">&gt;= 1.5</td>
<td style="text-align:center">&gt;= 2.17</td>
</tr>
<tr>
<td style="text-align:center">&lt;= 1.4</td>
<td style="text-align:center">&gt;= 2.12</td>
</tr>
</tbody>
</table>
<p>å¦‚æœç‰ˆæœ¬ä¸åŒ¹é…å¯èƒ½ä¼šæŠ¥ï¼š</p>
<p><em><strong>/lib64/libc.so.6: version `GLIBC_2.34&rsquo; not found</strong></em></p>
</li>
</ul>


        <hr style="visibility: hidden;" />
        <ul class="pager">
          
          <li class="previous">
            <a href="/posts/goland_remote_connect/" data-toggle="tooltip" data-placement="top" title="Goland è¿œç¨‹å¼€å‘">
              Previous<br>
              <span>Goland è¿œç¨‹å¼€å‘</span>
            </a>
          </li>
          
          
          <li class="next">
            <a href="/posts/vercal_chatgpt/" data-toggle="tooltip" data-placement="top" title="Verceléƒ¨ç½²ChatGPT">
              Next<br>
              <span>Verceléƒ¨ç½²ChatGPT</span>
            </a>
          </li>
          
        </ul>
        <hr style="visibility: hidden;" />

        
        






      </div>

      
      
      
      
      <div class="
              col-lg-8 col-lg-offset-2
              col-md-10 col-md-offset-1
              sidebar-container">

        
        
        <section>
  
  
  <hr class="hidden-sm hidden-xs">
  
  <h5>FEATURED TAGS</h5>
  <div class="tags">
    
    <a href="/tags/chatgpt/">chatgpt</a>
    
    <a href="/tags/clickhouse/">clickhouse</a>
    
    <a href="/tags/goland/">goland</a>
    
    <a href="/tags/golang/">golang</a>
    
    <a href="/tags/remote/">remote</a>
    
    <a href="/tags/tensorflow/">tensorflow</a>
    
    <a href="/tags/vercel/">vercel</a>
    
  </div>
</section>

        
        

      </div>
    </div>
  </div>
</article>



  
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        <ul class="list-inline text-center"></ul>

        <p class="copyright text-muted">
          Copyright &copy; JARVIS 2023  
          <br>
          Powered by <a href="https://gohugo.io">Hugo</a>
        </p>
      </div>
    </div>
  </div>
</footer>

<script src=/js/jquery.min.js></script>
<script src=/js/bootstrap.min.js crossorigin="anonymous"></script>



<script src="/js/hux-blog.min.c4ea77041cd3edbfc8b2622cd887a9a5d8760a4162d14489e36d2a3fa4c90172.js"></script>


<script src=/js/simple-jekyll-search.min.js></script>


<script src="/js/search.min.53bce5da475b4d362500e5ce5dddfa22e20e1b9018777411d2020b4b839c9310.js"></script>













<script src="/zoomjs/zoom.min.js"></script>

</body>

</html>